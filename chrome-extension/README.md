# 予約状況自動更新システム - 設定手順書

## 📋 全体の流れ

1. Google Apps Scriptを設定（スプレッドシートに書き込むため）
2. Chrome拡張機能を設定
3. テスト

---

## ステップ1：Google Apps Scriptの設定

### 1-1. スクリプトエディタを開く

1. Googleスプレッドシートを開く
   https://docs.google.com/spreadsheets/d/1RSd9aC5B_-gQ1_j5V1aQcZn1iVw9v8mpmhJ78_8gY80/edit

2. メニューから「拡張機能」→「Apps Script」をクリック

### 1-2. コードを貼り付け

1. エディタに表示されているコードを全て削除

2. `google-apps-script.js` の内容を全てコピーして貼り付け

3. 「保存」ボタンをクリック（ディスクアイコン）

### 1-3. Web Appとしてデプロイ

1. 右上の「デプロイ」→「新しいデプロイ」をクリック

2. 「種類の選択」で「ウェブアプリ」を選択

3. 設定：
   - 説明：「予約状況自動更新」（任意）
   - 次のユーザーとして実行：「自分」
   - アクセスできるユーザー：「全員」
   
4. 「デプロイ」ボタンをクリック

5. 初回は承認が必要：
   - 「アクセスを承認」をクリック
   - Googleアカウントを選択
   - 「詳細」→「（プロジェクト名）に移動（安全ではないページ）」をクリック
   - 「許可」をクリック

6. **「ウェブアプリのURL」をコピー**して保存
   - 例：`https://script.google.com/macros/s/ABC...XYZ/exec`
   - このURLは後で使います

---

## ステップ2：Chrome拡張機能の設定

### 2-1. コードを修正

1. `content.js` を開く

2. 10行目付近を探す：
   ```javascript
   const GOOGLE_APPS_SCRIPT_URL = 'YOUR_GOOGLE_APPS_SCRIPT_URL_HERE';
   ```

3. `YOUR_GOOGLE_APPS_SCRIPT_URL_HERE` を、さっきコピーしたURLに置き換える：
   ```javascript
   const GOOGLE_APPS_SCRIPT_URL = 'https://script.google.com/macros/s/ABC...XYZ/exec';
   ```

4. 保存

### 2-2. アイコン画像を用意（オプション）

- 128x128ピクセルの画像を `icon.png` として保存
- または、`manifest.json` からアイコンの行を削除してもOK

### 2-3. Chromeに拡張機能を読み込む

1. Chrome（またはChromium）を開く

2. アドレスバーに `chrome://extensions/` と入力してEnter

3. 右上の「デベロッパーモード」をONにする

4. 「パッケージ化されていない拡張機能を読み込む」をクリック

5. `chrome-extension` フォルダを選択

6. 拡張機能が表示されればOK！

---

## ステップ3：テスト

### 3-1. 予約ページを開く

1. https://ckreserve.com/clinic/fujiminohikari-ganka/fujimino にアクセス

2. 右下に「🔄 予約状況を更新する」ボタンが表示される

### 3-2. ボタンをクリック

1. ボタンをクリック

2. 「⏳ 確認中...」→「✅ 更新完了！」と表示される

### 3-3. スプレッドシートを確認

1. スプレッドシートを開く

2. 新しい行が追加されているか確認
   - タイムスタンプ
   - 「空きあり」または「「満」」

---

## 🎉 完成！

これで、予約ページを開いてボタンを1回クリックするだけで、自動的にスプレッドシートに記録されます！

---

## 💡 使い方（毎日）

1. 予約ページを開く
2. 右下のボタンをクリック
3. 完了！（合計2秒）

---

## ⚠️ トラブルシューティング

### ボタンが表示されない

- ページを再読み込み（F5）
- 拡張機能が有効になっているか確認（chrome://extensions/）

### 「❌ エラーが発生しました」と表示される

- Google Apps ScriptのURLが正しいか確認
- スプレッドシートの共有設定を確認
- ブラウザのコンソール（F12）でエラーを確認

### スプレッドシートに記録されない

- Google Apps Scriptのデプロイ設定を確認
- 「アクセスできるユーザー：全員」になっているか確認

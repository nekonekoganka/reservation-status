# 予約状況インジケーター

## 📌 概要

ふじみ野ひかり眼科の一般予約と視野予約の状況をChromeツールバーのバッジに表示するChrome拡張機能です。

## ✨ 機能

### バッジ表示

| 状態 | バッジ | 色 | 意味 |
|------|--------|-----|------|
| 両方空き | `2` | 🟢 緑 | 一般予約・視野予約ともに空きあり |
| 一般のみ空き | `G` | 🟡 黄 | 一般予約のみ空きあり |
| 視野のみ空き | `S` | 🟡 黄 | 視野予約のみ空きあり |
| 両方満枠 | `0` | 🔴 赤 | 両方とも満枠 |

### ポップアップ表示

拡張機能アイコンをクリックすると、詳細な予約状況を確認できます：

```
ふじみ野ひかり眼科
予約状況

一般予約   ⭕ 空き
視野予約   😔 満枠

[一般] [視野] [統合]

更新: 11/14 14:23
```

### 自動更新

- **更新間隔**: 1分ごと
- **データ取得元**: Googleスプレッドシート
  - 一般予約: `フォームの回答 1`
  - 視野予約: `フォームの回答_視野予約`

---

## 🚀 インストール手順

### 1. リポジトリをクローンまたはダウンロード

```bash
git clone https://github.com/nekonekoganka/reservation-status.git
cd reservation-status/chrome-extension-status-indicator
```

### 2. Chromeにインストール

1. **Chromeを開く**

2. **拡張機能ページを開く**
   - アドレスバーに `chrome://extensions/` を入力してEnter

3. **デベロッパーモードをON**
   - 右上の「デベロッパーモード」トグルをON

4. **拡張機能を読み込む**
   - 「パッケージ化されていない拡張機能を読み込む」をクリック
   - `chrome-extension-status-indicator` フォルダを選択

5. **完了！**
   - Chromeツールバーに拡張機能アイコンが表示されます
   - バッジに予約状況が表示されます

---

## 📖 使い方

### ツールバーで確認

- **バッジの色と文字**で予約状況を一目で確認
- マウスオーバーでツールチップに状態を表示

### 詳細を確認

1. **拡張機能アイコンをクリック**
2. ポップアップが開き、詳細な予約状況を表示
3. ボタンをクリックして各ディスプレイページを開く
   - 「一般」→ 一般予約ディスプレイ
   - 「視野」→ 視野予約ディスプレイ
   - 「統合」→ 統合ディスプレイ

---

## ⚙️ 技術仕様

### 使用技術

- **Manifest V3**: 最新のChrome拡張機能仕様
- **Service Worker**: バックグラウンドで動作
- **Chrome Storage API**: 状態の保存
- **Chrome Alarms API**: 定期的な更新

### パーミッション

- `alarms`: 定期的な状態チェック
- `storage`: 状態の保存
- `https://docs.google.com/*`: スプレッドシートへのアクセス

### ファイル構成

```
chrome-extension-status-indicator/
├── manifest.json       # 拡張機能の設定
├── background.js       # バックグラウンド処理
├── popup.html          # ポップアップUI
├── popup.js            # ポップアップのロジック
├── README.md           # このファイル
└── icons/              # アイコン画像（要追加）
    ├── icon16.png
    ├── icon48.png
    └── icon128.png
```

---

## 🎨 アイコンについて

現在、アイコン画像が未設定です。以下のいずれかの方法で追加してください：

### 方法1: シンプルなアイコンを作成

16px、48px、128pxの3サイズのPNG画像を用意し、`icons/` フォルダに配置します。

### 方法2: 仮のアイコンを使用

一時的に他の画像ファイルをコピーして使用することも可能です。

---

## 🔧 カスタマイズ

### 更新間隔を変更

**background.js** の6行目を編集：

```javascript
const UPDATE_INTERVAL_MINUTES = 1; // この数値を変更（単位：分）
```

例：
- 30秒ごと → `0.5`
- 2分ごと → `2`
- 5分ごと → `5`

### バッジの表示を変更

**background.js** の `updateBadgeByStatus()` 関数を編集して、バッジのテキストや色をカスタマイズできます。

---

## 🐛 トラブルシューティング

### バッジが「?」と表示される

- **原因**: データ取得エラー
- **解決方法**:
  1. インターネット接続を確認
  2. スプレッドシートのURLが正しいか確認
  3. 拡張機能を再読み込み

### バッジが表示されない

- **原因**: 拡張機能が正しく読み込まれていない
- **解決方法**:
  1. `chrome://extensions/` を開く
  2. エラーがないか確認
  3. 拡張機能を再読み込み

### ポップアップが開かない

- **原因**: popup.htmlのパスが間違っている
- **解決方法**:
  1. `manifest.json` の `action.default_popup` を確認
  2. `popup.html` がフォルダ内に存在するか確認

---

## 💡 Tips

### タスクバーにピン留め

Windowsタスクバーにピン留めすることで、Chrome未起動時でも確認できます：

1. Chromeをタスクバーにピン留め
2. Chromeを起動すると拡張機能のバッジが表示される

### ツールバーに固定

拡張機能アイコンをツールバーに常に表示：

1. 拡張機能アイコンをクリック
2. ピンアイコン📌をクリック

---

## 📝 ライセンス

このプロジェクトは私的利用を目的としています。

---

## 🙏 サポート

質問や問題がある場合は、GitHubのIssuesでお知らせください。
